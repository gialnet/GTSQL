SELECT COUNT(*) FROM DOMIVEHI   

523

SELECT COUNT(*) FROM VEHICULOS WHERE DOMICILIADO='S' AND ABONADO IN (
SELECT RECIBO FROM DOMIVEHI)

67

(3190,4287,4716,5431,10715,11104,11105,11106,11107,13679,14042,14514,15124,15155,15156,16180,24327,27974,28618,29189,
29285,32716,34093,38938,39824,39825,43414,43451,44543,45353,46380,46381,46684,49143,49147,49148,49149,49150,49152,
49153,49154,49934,51745,54014,54574,54851,56313,57999,58160,58568,58915,59083,59336,60096,60430,60704,61189,61392,
61520,62001,62099,62682,62884,63534,64169,64211,64999)

SELECT R.ABONADO,D.RECIBO,R.NIF,R.NOMBRE,R.DOMICILIADO,R.ENTIDAD,R.SUCURSAL,R.DC,R.CUENTA,
D.ENTIDAD,D.SUCURSAL,D.DC,D.CUENTA,R.TOTAL,D.CUOTA
FROM RECIBOS_VEHI R,DOMIVEHI D
WHERE R.ABONADO=D.RECIBO AND R.MUNICIPIO='148' AND R.YEAR='2003' AND R.PERIODO='00'

SELECT V.ABONADO,D.RECIBO,V.NIF,V.DOMICILIADO,V.ENTIDAD,V.SUCURSAL,V.DC,V.CUENTA,V.F_DOMICILIACION,V.TITULAR,
D.ENTIDAD,D.SUCURSAL,D.DC,D.CUENTA
FROM VEHICULOS V,DOMIVEHI D
WHERE V.ABONADO=D.RECIBO AND V.MUNICIPIO='148'

SELECT * FROM DOMIVEHI WHERE SUCURSAL NOT IN (SELECT SUCURSAL
FROM OFICINAS WHERE ENTIDAD=DOMIVEHI.ENTIDAD)

2038-4404,2038-2986,2085-8067,2085-8079,2104-0634,2104-3335,2101-0888,0075-1194,2038-2704,2100-3875,
2038-1530,2038-2949,2085-8027,2100-4466,

INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2038','4404','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2038','2986','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2085','8067','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2085','8079','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2104','0634','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2104','3335','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2101','0888','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('0075','1194','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2038','2704','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2100','3875','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2038','1530','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2038','2949','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2085','8027','OFICINA CARGADA DESDE CUADERNO 60');
INSERT INTO OFICINAS (ENTIDAD,SUCURSAL,NOMBRE) VALUES ('2100','4466','OFICINA CARGADA DESDE CUADERNO 60');


/**************************CARGAR DOMICILIACIONES****************************/

CREATE OR REPLACE PROCEDURE CARGA_DOMIVEHI
AS
   xNADA INT;
   CURSOR C1 IS SELECT V.ABONADO,V.NIF,D.ENTIDAD,D.SUCURSAL,D.DC,D.CUENTA 
  		 	   FROM VEHICULOS V, DOMIVEHI D
 			   WHERE V.ABONADO=D.RECIBO AND V.DOMICILIADO='N';

BEGIN
   FOR v1 IN C1
   LOOP
      update usuariosgt set texto2='' where usuario=user;
      VEHI_BANCOS(v1.ABONADO,'S',v1.ENTIDAD,v1.SUCURSAL,v1.DC,v1.CUENTA,SYSDATE,v1.NIF,xNADA);
   END LOOP;
END;
/

EXECUTE CARGA_DOMIVEHI;
DROP PROCEDURE CARGA_DOMIVEHI;
DROP TABLE DOMIVEHI;



